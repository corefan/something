<!DOCTYPE html>
<html>
<head lang="ko">
    <meta charset="UTF-8">
    <title>2d cube</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,target-densitydpi=high-dpi "/>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
    </style>
</head>
<body>
<div style="position: absolute; left:0px; top:0px; width: 512px; height: 512px; border: 3px solid #eeeeee; overflow:hidden;">    
	<canvas id="stage" width="512" height="512">
	</canvas>
</div>
<!--<div style="position: absolute; left:30px; top:300px; width: 400px; height: 300px; border: 3px solid #eeeeee;">    
    <video id="video" width="400px" height="300px"></video>
</div>-->
</body>
<script>
    (function(win, width, height){
        var cv = document.getElementById("stage");
        cv.width = width;
        cv.height = height;
        cv.parentNode.style.width = width + "px";
        cv.parentNode.style.height = height + "px";

        function getRotatePoint(angle, x, y){
            var degree = Math.atan(y/x) + Math.PI*0.5;
            var distance = Math.sqrt(x*x + y*y);
            x = Math.sin(angle*radian + degree).toFixed(7)*distance;
            y = -Math.cos(angle*radian + degree).toFixed(7)*distance;
            
            return {
                "x" : x,
                "y" : y
            };        
        }
        
        function getRotatePoint2(rad, x, y){
            var degree = Math.atan(y/x) + Math.PI*0.5;
            var distance = Math.sqrt(x*x + y*y);
            x = Math.sin(rad + degree).toFixed(7)*distance;
            y = -Math.cos(rad + degree).toFixed(7)*distance;
            
            return {
                "x" : x,
                "y" : y
            };        
        }
        
        var radian = Math.PI/180;

        var ctx = cv.getContext("2d");
            

        // ctx.transform(1, 30*radian, -30*radian, 1, 0, 0);
        var sin, cos, angle, dd, changed_pos;
        angle = 30;
        sin = Math.sin(angle/180*Math.PI);
        cos = Math.cos(angle/180*Math.PI);
        dd = Math.sqrt(2)*50;

        ctx.save();
        // ctx.translate(100*cos, -100*sin)
        // ctx.rotate(30*radian);
        ctx.strokeStyle = "rgba(0, 0, 0, 1)";
        ctx.strokeRect(206, 206, 200, 100);
        ctx.restore();
        
                
        // ctx.save();
        // changed_pos = getRotatePoint(angle, 100, 50);
        // ctx.transform(cos, sin, -sin, cos, 206 + 100 -changed_pos.x, 206 + 50 -changed_pos.y);    
        // ctx.fillStyle = "rgba(255, 0, 0, 0.5)";
        // ctx.fillRect(0, 0, 200, 100);
        // ctx.restore();
                
        ctx.save();
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 206 + 100 -changed_pos.x, 206 + 50 -changed_pos.y);    
        ctx.fillStyle = "rgba(255, 0, 0, 0.5)";
        ctx.fillRect(0, 0, 200, 100);
        ctx.restore();
                 
        ctx.save();
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 206 + 100 -changed_pos.x, 206 + 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        ctx.fillStyle = "rgba(255, 128, 0, 0.5)";
        ctx.fillRect(0, 0, 200, 100);
        ctx.restore();

        ctx.save();
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 206 + 100 -changed_pos.x, 206 + 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);        
        ctx.fillStyle = "rgba(255, 255, 0, 0.5)";
        ctx.fillRect(0, 0, 200, 100);
        ctx.restore();
        
        ctx.save();
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 206 + 100 -changed_pos.x, 206 + 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);                
        ctx.fillStyle = "rgba(0, 192, 0, 0.5)";
        ctx.fillRect(0, 0, 200, 100);
        ctx.restore();
        
        ctx.save();
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 206 + 100 -changed_pos.x, 206 + 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);  
        ctx.fillStyle = "rgba(0, 192, 192, 0.5)";
        ctx.fillRect(0, 0, 200, 100);
        ctx.restore();
        
        ctx.save();
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 206 + 100 -changed_pos.x, 206 + 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);  
        changed_pos = getRotatePoint(angle, 100, 50);
        ctx.transform(cos, sin, -sin, cos, 100 -changed_pos.x, 50 -changed_pos.y);          
        ctx.fillStyle = "rgba(0, 0, 192, 0.5)";
        ctx.fillRect(0, 0, 200, 100);
        ctx.restore();
        
               
        
        // ------------------------------------------------------------
               
        ctx.save();
        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.fillRect(255, 255, 3, 3);
        ctx.restore();

        ctx.save();
        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.fillRect(305, 255, 3, 3);
        ctx.restore();
               
        ctx.save();
        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.fillRect(255, 305, 3, 3);
        ctx.restore();
                              
        
        ctx.save();
        var aa = getRotatePoint(angle, 50, 0);
        ctx.fillStyle = "rgba(128, 255, 128, 1)";
        ctx.fillRect(255+aa.x, 255+aa.y, 3, 3);
        ctx.restore();
        
        ctx.save();
        var aa = getRotatePoint(angle, 0, 50);
        ctx.fillStyle = "rgba(255, 255, 255, 1)";
        ctx.fillRect(255+aa.x, 255+aa.y, 3, 3);
        ctx.restore();

        
        // ctx.save();
        // var aa = getRotatePoint(45, 50, 50);    
        // ctx.fillStyle = "rgba(0, 0, 255, 1)";
        // ctx.fillRect(206+dd - 1, 206+dd - 1, 3, 3);
        // ctx.restore();

        
        
    })(this, 512, 512);
</script>
</html>
